plot(x,cex.lab=4,xlab="t",cex.axis=1.3)
points(max.ind,x[max.ind],col="red")
# ---------------------------- Slide 29 -----------------------------
par(mfrow=c(1,4),mgp=c(3,0.8,0),mar=c(5,5,2.5,0.6))
alpha <- c(1/3,1/2,1/6)
ns <- c(10,100,1000,10000)
# For samples sizes n=10,100,..., sample n standard Frechet and
#   and produce the MovingMax(alpha) process
for(k in seq_along(ns)){
n <- ns[k]+2
y <- rgev(n,0,1,1)
x <- c()
for(i in 3:length(y)){
x <- c(x,sum(y[(i-2):i]*alpha))
}
#expression(X[t]/n)
if(k==1){
plot(c(1:length(x))/(length(x)+1),x/length(x),ylab="YYYYY",main=paste0("n=",length(x)),
xlab="XXXXX",cex.lab=2,cex.axis=1.4,cex.main=2)
}
else{
plot(c(1:length(x))/(length(x)+1),x/length(x),ylab="",main=paste0("n=",length(x)),
xlab="XXXXX",cex.lab=2,cex.axis=1.4,cex.main=2)
}
}
# ---------------------------- Slide 39 -----------------------------
library(ismev)
# Obtain the rainfall data set
data("rain")
dts <- rep(c(1914:1961),each=365)
dts <- c(dts,rep(1962,length(rain)-length(dts)))
par(mfrow=c(1,1),mar=c(4.1,6.1,0.5,2.1))
plot(rain,ylab="YYYYY",xlab="XXXXX",
cex.lab=2,cex.axis=1.5,xaxt="n")
axis(1,at=seq(1,(1962-1914)*365,by=365*4),labels=seq(1914,1961,by=4))
# ---------------------------- Slide 40 -----------------------------
library(evd)
thetas1 <- c()
thetas2 <- c()
thetas3 <- c()
us <- c(4:35)
for(u in us){
thetas1 <- c(thetas1,exi(rain,u=u,r=1))
thetas2 <- c(thetas2,exi(rain,u=u,r=2))
thetas3 <- c(thetas3,exi(rain,u=u,r=0))
}
par(mfrow=c(1,1),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
lines(us,thetas3,col="red",lwd=2)
legend(25,0.6,legend=c("m=1","m=2"),col=c("black","blue"),
lty=c(1,1),lwd = c(2,2))
abline(h=1,lty="dotted")
lines(us,CIs[,1],lty="dotted")
lines(us,CIs[,2],lty="dotted")
lines(us,CIs[,3],lty="dotted",col="blue")
lines(us,CIs[,4],lty="dotted",col="blue")
lines(us,CIs[,5],lty="dotted",col="red")
lines(us,CIs[,6],lty="dotted",col="red")
plot(polygon(x=c(CIs[,1]),rev(CIs[,2])),col="lightgrey")
plot(polygon(x=c(CIs[,1]),y=rev(CIs[,2])),col="lightgrey")
p <- polygon(x=c(us,rev(us),
y=c(CIs[,1]),rev(CIs[,2]),col="lightgrey"))
us
CIs[,1])
CIs[,1]
CIs[,2]
p <- polygon(x=c(us,rev(us)),
y=c(CIs[,1],rev(CIs[,2]),col="lightgrey"))
c(us,rev(us))
c(CIs[,1],rev(CIs[,2])
p <- polygon(x=c(us,rev(us)),
c(CIs[,1],rev(CIs[,2]))
p <- polygon(x=c(us,rev(us)),
y=c(CIs[,1],rev(CIs[,2])),col="lightgrey")
par(mfrow=c(1,1),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
lines(us,thetas3,col="red",lwd=2)
legend(25,0.6,legend=c("m=1","m=2"),col=c("black","blue"),
lty=c(1,1),lwd = c(2,2))
abline(h=1,lty="dotted")
lines(us,CIs[,1],lty="dotted")
lines(us,CIs[,2],lty="dotted")
lines(us,CIs[,3],lty="dotted",col="blue")
lines(us,CIs[,4],lty="dotted",col="blue")
lines(us,CIs[,5],lty="dotted",col="red")
lines(us,CIs[,6],lty="dotted",col="red")
plot(p)
p
p <- polygon(x=c(us,rev(us)),
y=c(CIs[,1],rev(CIs[,2])),col="lightgrey")
p <- polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col="lightgrey")
p
par(mfrow=c(1,1),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
lines(us,thetas3,col="red",lwd=2)
legend(25,0.6,legend=c("m=1","m=2"),col=c("black","blue"),
lty=c(1,1),lwd = c(2,2))
abline(h=1,lty="dotted")
lines(us,CIs[,1],lty="dotted")
lines(us,CIs[,2],lty="dotted")
lines(us,CIs[,3],lty="dotted",col="blue")
lines(us,CIs[,4],lty="dotted",col="blue")
lines(us,CIs[,5],lty="dotted",col="red")
lines(us,CIs[,6],lty="dotted",col="red")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col="lightgrey")
lines(us,thetas1)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col="lightgrey",border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(211,211,211,0.4),border="lightgrey")
211/256
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.4),border="lightgrey")
par(mfrow=c(1,1),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
lines(us,thetas3,col="red",lwd=2)
legend(25,0.6,legend=c("m=1","m=2"),col=c("black","blue"),
lty=c(1,1),lwd = c(2,2))
abline(h=1,lty="dotted")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0.8,0.8,0.8,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.7),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0.8,0.8,0.8,0.7),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.8),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0.8,0.8,0.8,0.8),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.8),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0,0,1,0.8),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0,0,1,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0,0,1,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0,0,0.6,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0,0,0.1,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0,0,1,0.4),border="lightgrey")
par(mfrow=c(1,2),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
lines(us,thetas3,col="red",lwd=2)
legend(25,0.6,legend=c("m=1","m=2"),col=c("black","blue"),
lty=c(1,1),lwd = c(2,2))
abline(h=1,lty="dotted")
lines(us,CIs[,1],lty="dotted")
lines(us,thetas1)
lines(us,CIs[,2],lty="dotted")
lines(us,CIs[,3],lty="dotted",col="blue")
lines(us,CIs[,4],lty="dotted",col="blue")
lines(us,CIs[,5],lty="dotted",col="red")
lines(us,CIs[,6],lty="dotted",col="red")
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),col=rgb(0.8,0.8,0.8,0.4),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),col=rgb(0,0,1,0.4),border="lightgrey")
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(1,0,0,0.6),border="lightgrey")
par(mfrow=c(1,2),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0,0,1,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(1,0,0,0.6),border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0,0,1,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2,col="red")
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(1,0,0,0.6),border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,col="blue",lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,0.5,2.1))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,0.5,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",cex.main=2,
cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
# Set current wd to KAUST_Course
# setwd(".../KAUST_Course/")
SP500 <- read.table("Data/SP500_daily.csv", header=TRUE, sep=",")
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY"
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
theta.bootstrap <- function(X,n.samp,us){
CIs <- matrix(NA,ncol=6,nrow=length(us))
colnames(CIs) <- c("lower_r1","upper_r1","lower_r2","upper_r2","lower_fs","upper_fs")
for(i in seq_along(us)){
print(us[i])
thetas <- matrix(NA,ncol=3,nrow=n.samp)
for(j in 1:n.samp){
X.boot <- blockbootstrap(rain,47)
thetas[j,1] <- exi(X.boot,u=us[i],r=1)
thetas[j,2] <- exi(X.boot,u=us[i],r=2)
thetas[j,3] <- exi(X.boot,u=us[i],r=0)
}
CIs[i,c(1,2)] <- quantile(thetas[,1],c(0.025,0.975))
CIs[i,c(3,4)] <- quantile(thetas[,2],c(0.025,0.975))
CIs[i,c(5,6)] <- quantile(thetas[,3],c(0.025,0.975))
}
}
CIs <- theta.bootstrap(X,n.samp,us)
theta.bootstrap <- function(X,n.samp,us){
CIs <- matrix(NA,ncol=6,nrow=length(us))
colnames(CIs) <- c("lower_r1","upper_r1","lower_r2","upper_r2","lower_fs","upper_fs")
for(i in seq_along(us)){
print(paste("Bootsrap for u=",us[i]))
thetas <- matrix(NA,ncol=3,nrow=n.samp)
for(j in 1:n.samp){
X.boot <- blockbootstrap(rain,47)
thetas[j,1] <- exi(X.boot,u=us[i],r=1)
thetas[j,2] <- exi(X.boot,u=us[i],r=2)
thetas[j,3] <- exi(X.boot,u=us[i],r=0)
}
CIs[i,c(1,2)] <- quantile(thetas[,1],c(0.025,0.975))
CIs[i,c(3,4)] <- quantile(thetas[,2],c(0.025,0.975))
CIs[i,c(5,6)] <- quantile(thetas[,3],c(0.025,0.975))
}
}
CIs <- theta.bootstrap(X,n.samp,us)
theta.bootstrap <- function(X,n.samp,us,block.size){
CIs <- matrix(NA,ncol=6,nrow=length(us))
colnames(CIs) <- c("lower_r1","upper_r1","lower_r2","upper_r2","lower_fs","upper_fs")
for(i in seq_along(us)){
print(paste("Bootsrap for u =",us[i]))
thetas <- matrix(NA,ncol=3,nrow=n.samp)
for(j in 1:n.samp){
X.boot <- blockbootstrap(X,block.size)
thetas[j,1] <- exi(X.boot,u=us[i],r=1)
thetas[j,2] <- exi(X.boot,u=us[i],r=2)
thetas[j,3] <- exi(X.boot,u=us[i],r=0)
}
CIs[i,c(1,2)] <- quantile(thetas[,1],c(0.025,0.975))
CIs[i,c(3,4)] <- quantile(thetas[,2],c(0.025,0.975))
CIs[i,c(5,6)] <- quantile(thetas[,3],c(0.025,0.975))
}
}
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
CIs
theta.bootstrap <- function(X,n.samp,us,block.size){
CIs <- matrix(NA,ncol=6,nrow=length(us))
colnames(CIs) <- c("lower_r1","upper_r1","lower_r2","upper_r2","lower_fs","upper_fs")
for(i in seq_along(us)){
print(paste("Bootsrap for u =",us[i]))
thetas <- matrix(NA,ncol=3,nrow=n.samp)
for(j in 1:n.samp){
X.boot <- blockbootstrap(X,block.size)
thetas[j,1] <- exi(X.boot,u=us[i],r=1)
thetas[j,2] <- exi(X.boot,u=us[i],r=2)
thetas[j,3] <- exi(X.boot,u=us[i],r=0)
}
CIs[i,c(1,2)] <- quantile(thetas[,1],c(0.025,0.975))
CIs[i,c(3,4)] <- quantile(thetas[,2],c(0.025,0.975))
CIs[i,c(5,6)] <- quantile(thetas[,3],c(0.025,0.975))
}
CIs
}
# Function to obtain moving block bootstrap from data set X
blockbootstrap <- function(X,blocksize){
n <- length(X)
boot.samp <- rep(NA,n)
ind <- c(1:n)
for(i in 1:(n/blocksize)){
ind.strt <- sample(ind,1,replace=T)
block.ind <- c(ind.strt:(ind.strt+blocksize-1)) %% n
if(length(which(block.ind==0))>0){
block.ind[which(block.ind==0)] <- n
}
ind.new.samp <- c(((i-1)*blocksize+1): (i*blocksize))
boot.samp[ind.new.samp] <- X[block.ind]
}
boot.samp
}
theta.bootstrap <- function(X,n.samp,us,block.size){
CIs <- matrix(NA,ncol=6,nrow=length(us))
colnames(CIs) <- c("lower_r1","upper_r1","lower_r2","upper_r2","lower_fs","upper_fs")
for(i in seq_along(us)){
print(paste("Bootsrap for u =",us[i]))
thetas <- matrix(NA,ncol=3,nrow=n.samp)
for(j in 1:n.samp){
X.boot <- blockbootstrap(X,block.size)
thetas[j,1] <- exi(X.boot,u=us[i],r=1)
thetas[j,2] <- exi(X.boot,u=us[i],r=2)
thetas[j,3] <- exi(X.boot,u=us[i],r=0)
}
CIs[i,c(1,2)] <- quantile(thetas[,1],c(0.025,0.975))
CIs[i,c(3,4)] <- quantile(thetas[,2],c(0.025,0.975))
CIs[i,c(5,6)] <- quantile(thetas[,3],c(0.025,0.975))
}
CIs
}
CIs <- theta.bootstrap(X,n.samp,us)
CIs <- theta.bootstrap(X,n.samp,us,47)
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
rain
CIs <- theta.bootstrap(rain,n.samp,us,47)
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.9),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.9),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,9])),col=rgb(0.8,0.8,0.8,0.6),border="lightgrey")
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col=rgb(0.8,0.8,0.8,0.9),border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col=rgb(0.8,0.8,0.8,0.9),border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col=rgb(0.8,0.8,0.8,0.9),border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
lines(us,thetas2,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col="lightgrey",border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col="lightgrey",border="lightgrey")
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col="lightgrey",border="lightgrey")
abline(h=1,lty="dotted")
par(mfrow=c(1,2),mar=c(4.1,6.1,2,0.2))
plot(us,thetas1,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="WWWW",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,1],rev(CIs[,2])),
col="lightgrey",border="lightgrey")
polygon(x=c(us,rev(us)),y=c(CIs[,3],rev(CIs[,4])),
col="lightgrey",border="lightgrey")
lines(us,thetas1,lwd=2)
lines(us,thetas2,lwd=2)
abline(h=1,lty="dotted")
plot(us,thetas3,type="l",ylim=c(0.3,1.05),
xlab="u",ylab="theta",main="YYYYYYYYYYYYY",
cex.main=2,cex.lab=2,cex.axis=1.5,lwd=2)
polygon(x=c(us,rev(us)),y=c(CIs[,5],rev(CIs[,6])),col="lightgrey",border="lightgrey")
lines(us,thetas3,lwd=2)
abline(h=1,lty="dotted")
